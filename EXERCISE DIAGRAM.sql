CREATE DATABASE H_B_M_S
USE H_B_M_S
--Creation table
create table Hotel(
Hotel_no varchar(8) primary key not null,
Hotel_name varchar(20) not null,
Hotel_address varchar(20) not null);

--insertion
INSERT INTO HOTEL VALUES('GROS1001', 'GROSVENOR HOTEL', 'LONDON');
INSERT INTO HOTEL VALUES('CAS1001', 'CASOOD HOTEL', 'HARGAYSA');
INSERT INTO HOTEL VALUES('SAF1001', 'SAFARI HOTEL', 'BOORAMA');
INSERT INTO HOTEL VALUES('IST1001', 'ISTANBUL HOTEL', 'JIGJIGA');
INSERT INTO HOTEL VALUES('SAF1002', 'SAFARI HOTEL', 'BOORAMA');
INSERT INTO HOTEL VALUES('JEES1001', 'JEES HOTEL', 'HARGAYSA');

SELECT *FROM GUEST
--Creation table
create table ROOM(
Room_no varchar(8) primary key not null,
Hotel_no_ varchar(8) foreign key references hotel(hotel_no),
Room_type varchar(20) NOT NULL,
Room_price decimal(5,2) NOT NULL);
alter table ROOM ALTER COLUMN ROOM_NO NUMERIC null; 
ALTER TABLE BOOKING DROP COLUMN ROOM_NO
ALTER TABLE ROOM DROP COLUMN HOTEL_NO
SELECT * FROM ROOM
--insertion
INSERT INTO ROOM VALUES ('RM1001', 'GROS1001', 'SINGLE', 72.00); 
INSERT INTO ROOM VALUES ('RM1002', 'CAS1001', 'DOUBLE', 25.00); 
INSERT INTO ROOM VALUES ('RM1003', 'SAF1001', 'KING', 69.99); 
INSERT INTO ROOM VALUES ('RM1004', 'IST1001', 'DOUBLE', 80.00); 
INSERT INTO ROOM VALUES ('RM1005', 'SAF1002', 'DOUBLE', 29.99); 
INSERT INTO ROOM VALUES ('RM1006', 'JEES1001', 'QUAD', 149.99); 
select * from ROOM

--Creation table
create table Guest(
guest_no varchar(10) primary key not null,
guest_name varchar(20) not null,
address varchar(20) NOT NULL);

--insertion
INSERT INTO GUEST VALUES ('G111', 'JOHN SMITH', 'LONDON');
INSERT INTO GUEST VALUES ('G112', 'AHMED HUSSEN', 'DUBAI');
INSERT INTO GUEST VALUES ('G113', 'OMER ALI', 'MAGADISHU');
INSERT INTO GUEST VALUES ('G114', 'FARAH ABDI', 'DOHA');
INSERT INTO GUEST VALUES ('G115', 'ABDIRAHMAN IDLE', 'ADISABABA');
INSERT INTO GUEST VALUES ('G116', 'ADAN MAHAMED', 'CAIRO');

--Creation table
create table Booking(
Hotel_no varchar(8) foreign key references hotel(hotel_no),
Guest_no varchar(10) foreign key references guest(guest_no),
Room_no varchar(8) foreign key references Room(room_no),
Date_form DATE not null,
Date_To date NOT NULL,
constraint Pk_booking primary key (Hotel_no, guest_no, date_form)
);

select * from booking
--insertion
INSERT INTO BOOKING VALUES ('CAS1001', 'G111', 'RM1001', '2023-4-16', '2023-5-2');
INSERT INTO BOOKING VALUES ('GROS1001', 'G112', 'RM1002', '2023-4-16', '2023-4-29');
INSERT INTO BOOKING VALUES ('JEES1001', 'G113', 'RM1003', '2023-4-17','2023-5-5');
INSERT INTO BOOKING VALUES ('SAF1001', 'G114', 'RM1004', '2023-4-15','2023-5-2');
INSERT INTO BOOKING VALUES ('IST1001', 'G115', 'RM1005',  '2023-4-15','2023-5-11');
INSERT INTO BOOKING VALUES ('SAF1002', 'G116', 'RM1006', '2023-4-17','2023-5-1');

---Simple queries
SELECT *
FROM BOOKING
 order by GUEST_NO

SELECT GUEST_NAME, HOTEL_NAME, hotel_address, ROOM_PRICE
FROM GUEST, HOTEL, ROOM, BOOKING;

SELECT GUEST_NAME, ADDRESS
FROM GUEST order by  guest_name ASC;

 SELECT GUEST_NAME, ADDRESS, HOTEL_NAME
FROM GUEST, HOTEL order by  guest_name DESC;

select * from hotel 
where hotel_address='london';

select count(*) from Guest;

SELECT *FROM BOOKING INNER JOIN HOTEL ON HOTEL. HOTEL_NAME=HOTEL. HOTEL_NAME


SELECT *FROM BOOKING FULL JOIN HOTEL ON HOTEL. HOTEL_NAME=HOTEL. HOTEL_NAME

SELECT *FROM BOOKING INNER JOIN GUEST ON GUEST.address=GUEST.address
INNER JOIN HOTEL ON HOTEL.hotel_name= hotel.hotel_name

SELECT *FROM BOOKING LEFT JOIN HOTEL ON HOTEL. HOTEL_NAME=HOTEL. HOTEL_NAME

SELECT *FROM BOOKING RIGHT JOIN HOTEL ON HOTEL. HOTEL_NAME=HOTEL. HOTEL_NAME

SELECT GUEST_NO, HOTEL_NO ADDRESS
FROM BOOKING

alter table bookING ALTER COLUMN ROOM_NO NUMERIC null; 
ALTER TABLE BOOKING DROP COLUMN ROOM_NO


SELECT  HOTEL_NAME 
FROM HOTEL;
UPDATE HOTEL SET HOTEL_NO='GROS001'
WHERE HOTEL_ADDRESS='LONDON'
UPDATE ROOM SET ROOM_TYPE='QUAD'
WHERE ROOM_NO=GRO112

DROP TABLE guest

alter table bookING ALTER COLUMN date_form date null; 
ALTER TABLE ROOM DROP COLUMN HOTEL_NO;
SELECT GUEST_NAME, ADDRESS 


select count(*) from hotel;
delete  from ROOM
DELETE  BOOKING
